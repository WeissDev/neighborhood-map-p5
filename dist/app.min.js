function initialize(){var e={zoom:13,center:new google.maps.LatLng(47.378236,8.539439),disableDefaultUI:!0};map=new google.maps.Map(document.getElementById("map-canvas"),e),setMarkers(allMarkers),determineVisibility()}function determineVisibility(){for(var e=0;e<allMarkers.length;e++)allMarkers[e].holdMarker.setMap(allMarkers[e].shouldDisplay===!0?map:null)}function setMarkers(e){for(var t=0;t<e.length;t++)e[t].holdMarker=new google.maps.Marker({position:new google.maps.LatLng(e[t].lat,e[t].lng),map:map,name:e[t].name,icon:{url:"img/map-marker-icon.png",size:new google.maps.Size(32,32),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(12.5,32)}}),streetViewImg=streetViewUrl+e[t].lat+","+e[t].lng,e[t].contentString="<strong>"+e[t].name+"</strong><br>"+e[t].street+"<br>"+e[t].city+'<br><p id="wiki-elem"></p><p style="font-style: italic;">'+e[t].comment+'</p><img src="'+streetViewImg+'" alt="Street View Image">',infoWindow=new google.maps.InfoWindow({maxWidth:200,content:e[t].contentString}),google.maps.event.addListener(e[t].holdMarker,"click",function(t,i){return function(){getWiki(e[i].name),infoWindow.setContent(e[i].contentString),map.setCenter(t.getPosition()),map.setZoom(16),infoWindow.open(map,this)}}(e[t].holdMarker,t)),$(document).on("click","#nav"+t,function(t,i){return function(){getWiki(e[i].name),infoWindow.setContent(e[i].contentString),map.setCenter(t.getPosition()),map.setZoom(16),infoWindow.open(map,t)}}(e[t].holdMarker,t))}function getWiki(e){var t="http://en.wikipedia.org/w/api.php?action=opensearch&search="+e+"&format=json&callback=wikiCallback",i=setTimeout(function(){$("#wiki-elem").text("failed to get wikipedia resources")},8e3);$.ajax({method:"GET",url:t,dataType:"jsonp",success:function(e){for(var t=e[1],a=0;a<t.length;a++)articleStr=t[a],fullUrl="http://en.wikipedia.org/wiki/"+articleStr,$("#wiki-elem").html('<img src="img/wiki-icon.png" alt="Wiki Icon"><a href="'+fullUrl+'">'+articleStr+"</a>");clearTimeout(i)}})}function getWeather(){var e="http://api.openweathermap.org/data/2.5/weather?id=2657896&APPID=44d1e8b52c6f16e94976ca04871c8382";$.ajax({method:"GET",url:e,dataType:"json",success:function(e){function t(e){var t=new Date(1e3*e),i=t.getHours()+":"+t.getMinutes();return i}var i=e.main.temp-273.15;weatherString="<h3>Today's weather in</h3><h2>"+e.name+", "+e.sys.country+'</h2><h3><img src="http://openweathermap.org/img/w/'+e.weather[0].icon+'.png">'+e.weather[0].main+", "+Math.round(10*i)/10+" °C</h3><p>"+e.weather[0].description+' today!</p><table style="width: 250px;"><tr><td>Pressure</td><td> '+e.main.pressure+" hPa</td></tr><tr><td>Humidity</td><td> "+e.main.humidity+"%</td></tr><tr><td>Sunrise</td><td> "+t(e.sys.sunrise)+"</td></tr><tr><td>Sunset</td><td> "+t(e.sys.sunset)+"</td></tr><tr><td>Wind</td><td> "+e.wind.speed+" m/s</td></tr></table><p>&copy; openweathermap.org</p>",$("#weather-container").html(weatherString)},error:function(){$("#weather-container").html("<h3>Weather data is currently unavailable.</h3>")}})}var map,infoWindow,fullUrl,streetViewImg,headImageView,streetViewUrl="https://maps.googleapis.com/maps/api/streetview?size=180x90&location=",wikiString,weatherString,links=$(".links"),$locName=$("#location-name"),allMarkers=[{name:"Zurich HB",lat:47.378236,lng:8.539439,street:"Museumstrasse 1",city:"8021 Zurich",id:"nav0",visible:ko.observable(!0),shouldDisplay:!0,comment:"The center of the city. A nice place to meet up with friends."},{name:"Chinagarten Zürich",lat:47.355176,lng:8.552384,street:"Bellerivestrasse 138",city:"8008 Zurich",id:"nav1",visible:ko.observable(!0),shouldDisplay:!0,comment:"A chinese garden nearby the lake where they keep some very exotic plants."},{name:"Limmatquai",lat:47.366925,lng:8.542937,street:"Quaibrücke",city:"8001 Zurich",id:"nav2",visible:ko.observable(!0),shouldDisplay:!0,comment:"A bridge crossing the Limmat river with a beautiful view over the Lake of Zurich"},{name:"Langstrasse",lat:47.37925,lng:8.527498,street:"Langstrasse",city:"8004 Zurich",id:"nav3",visible:ko.observable(!0),shouldDisplay:!0,comment:'English: "Long Street". A street in the heart of the city with a lot of bars and a vivid nightlife'},{name:"Letzigrund Stadium",lat:47.38222,lng:8.503871,street:"Badenerstrasse 500",city:"8048 Zurich",id:"nav4",visible:ko.observable(!0),shouldDisplay:!0,comment:"The biggest stadium in town, hosting sports events and concerts"},{name:"Zurich Opera House",lat:47.365566,lng:8.546964,street:"Sechseläutenplatz",city:"8058 Zurich Flughafen",id:"nav5",visible:ko.observable(!0),shouldDisplay:!0,comment:"Zurich's Opera House. A very fancy place. Dress up accordingly if you wish to go there."},{name:"University of Zurich",lat:47.374322,lng:8.550981,street:"Rämistrasse 71",city:"8006 Zurich",id:"nav6",visible:ko.observable(!0),shouldDisplay:!0,comment:"The largest University in Switzerland with over 26'000 students."},{name:"Zoo Zürich",lat:47.388304,lng:8.57706,street:"Zürichbergstrasse 221",city:"8044 Zurich",id:"nav7",visible:ko.observable(!0),shouldDisplay:!0,comment:"This zoo was first opened in 1929. As of 2004, it has over 200 specimens of 300 species."},{name:"Zürich Hardbrücke",lat:47.38657,lng:8.518361,street:"Hardstrasse",city:"8005 Zurich",id:"nav8",visible:ko.observable(!0),shouldDisplay:!0,comment:"Zurich's more modern district. It is among the most expensive places in town."}];initialize();var viewModel={query:ko.observable("")};viewModel.markers=ko.computed(function(){var e=this,t=e.query().toLowerCase();return ko.utils.arrayFilter(allMarkers,function(e){return e.name.toLowerCase().indexOf(t)>=0?(e.shouldDisplay=!0,e.visible(!0)):(e.shouldDisplay=!1,determineVisibility(),e.visible(!1))})},viewModel),ko.applyBindings(viewModel),$("#input").keyup(function(){determineVisibility()});var weatherVisible=!1;$("#weather-logo img").on("click",function(){weatherVisible?weatherVisible&&($("#weather-container").animate({bottom:"-400px"},200),$("#weather-logo").animate({bottom:"0px"},200),weatherVisible=!1):($("#weather-container").animate({bottom:"0px"},200),$("#weather-logo").animate({bottom:"400px"},200),weatherVisible=!0)});var navVisible=!1,$navHolder=$("#sidebar-outer");$("#arrow").on("click",function(){navVisible?navVisible&&($navHolder.animate({top:"-315px"},200),$("#arrow").animate({top:"0"},200).attr("src","img/arrow-down.svg"),navVisible=!1):($navHolder.animate({top:"35px"},200),$("#arrow").animate({top:"280px"},200).attr("src","img/arrow-up.svg"),navVisible=!0)}),$("#reset").on("click",function(){map.setZoom(13)}),getWeather();